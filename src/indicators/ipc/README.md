# IPC

IPC food insecurity data is extracted from the Humanitarian Data Exchange, where
it is stored in a [global dataset](https://data.humdata.org/dataset/ipc-country-data). 
The codebase for extracting and wrangling the data is done within
the [Ripc](https://github.com/OCHA-DAP/Ripc) R package. Details on the database can be
found within the R documentation for the package, but a brief outline is provided below.

## Introduction

By default, the data is stored in a messy tabular format, with subnational and national
data mixed together across different time periods, reporting the number (and percent) of
people currently within each food insecurity phase, and projected in the next one. IPC
analyses are almost always produced by generating an estimate of populations in each
phase in the current period and in the following projection period (typically 3-6 months
for each period).

## Methodology

The methodology for its use in the GMS is below.

### Tidy the data

First, the data in tabular format needs tidying. It is pulled into a format where
each row represents an analysis for a specific time period, and the columns are the
current or projected number and percent of people in each of the population phases. Once
tidied, the data is summarized from subnational to national level for flagging.

### Flagging

Flags are generated by comparing estimates for the current period to the following projected
period as well as to the previous current period. A flag is generated if there is a
projected increase from the current or observed increase from the previous current
figures. 

### Flagging dates

The start date is set to the date of the analysis, and the end date is set
to the last increase in the analysis. For instance, if the current figures are for
January to March, and they show higher food insecurity than the previous current
figures from October to December, a flag would be generated. If the projections
from April to June show an increase from the current period, then the overall
flag would be from January to June. However, if the projections from April to June
are that food insecurity will decrease, then the dates for the flagging will only
be for the period January to March when the current figures are higher than
the previous current figures.

## Output datasets

`flags_ipc.csv`: flagging dataset.

`raw_ipc.csv`: raw IPC output. This data is actually already in a clean format, but is
called raw because it includes subnational data and has not been aggregated to the
country level. Useful for exploring the subnational context of the alert.

`wrangled_ipc.csv`: wrangled IPC data. National level data that also includes the deltas
for each period (current or projected). The deltas for a current row are the differences
with the previous current period. The deltas for a projection row are the differences
between the first projection and current period in that analysis or between the second
projection and the first projection (if second projections included).
